## A poly-time test for difference terms in idempotent varieties

William DeMeo [&lt;williamdemeo@gmail.com&gt;](mailto:williamdemeo@gmail.com)  

joint work with  

Ralph Freese & Matt Valeriote  

<a style="color:#e7ad52">BLAST 2017 @ Vanderbilt<a style="color:#e7ad52">

---

## The Problem

- Can we efficiently decide whether a finite algebra $\mathbf{A}$ generates a variety with a difference term? <!-- .element: class="fragment" -->

- We prove that the answer is "yes" in the idempotent case. <!-- .element: class="fragment" -->

- Time permitting, we describe an algorithm for constructing difference terms. <!-- .element: class="fragment" -->

---

## Definitions

A <a style="color:#e7ad52"><i>difference term</i></a> for $\mathcal{V}$ is a term $d$ satisfying, $\forall \; \mathbf A \in \mathcal V$, $\forall a, b \in A$, 

$$d(a,a,b) = b \quad \text{ and } \quad
d(a,b,b) \mathrel{[\theta, \theta]} a$$

where $\theta$ is any congruence containing $(a,b)$ and $[\cdot, \cdot]$ is the <a style="color:#e7ad52"><i>commutator</i></a>.

---

## Problem Statement

Is there a poly-time algorithm that takes a finite
idempotent algebra $\mathbf{A}$ and decides 
whether $\mathbb{V}(\mathbf{A})$ has a difference term?

<div class="fragment" align="left"><a style="color:#e7ad52">**Theorem**</a> (Kearnes *J Algebra* 1995)   
$\mathbb{V}(\mathbf{A})$ has a diff term
$\Leftrightarrow$  $\mathbb{V}(\mathbf{A})$ omits 1's and type 2 tails
</div>

<div class="fragment" align="left">
Omitting 1's is poly-time decidable by Valeriote's subtype theorem.
</div>

<div class="fragment" align="left">
<a style="color:#e7ad52">**Reduced Problem**</a>   
Is there a poly-time algorithm that takes a finite 
idempotent algebra $\mathbf{A}$ and decides whether 
$\mathbb{V}(\mathbf{A})$ has nonempty type 2 tails?
</div>

---

## Strategy

  + (Kearnes) Having a difference term is characterized by omitting 1's and tails of type 2. <!-- .element: class="fragment" -->
  + (Valeriote) Omitting 1's is poly-time decidable by the subtype theorem. <!-- .element: class="fragment" -->
  + If there is a tail of type 2 in $\mathbb{V}(\mathbf{A})$, then there is a tail of type 2 "near the bottom" of $\mathbb{V}(\mathbf A)$. <!-- .element: class="fragment" -->
---

<div class="fragment" align="left">
<a style="color:#e7ad52">Main Theorem</a>
</div>

- Suppose $\mathbb{V}(\mathbf A)$ omits type 1 and contains a finite algebra $\mathbf{B}$ with a type 2 prime quotient $\alpha \prec \beta$ such that the $\langle \alpha, \beta \rangle$-minimal sets have non-empty tails. <!-- .element: class="fragment" -->
- Then there exists a 3-generated subalgebra of $\mathbf A \times \mathbf A$
  with this property. <!-- .element: class="fragment" -->
- **Conclusion:** to check for type 2 tails in $\mathbb{V}(\mathbf A)$, it suffices to look for them in 3-generated subalgebras of $\mathbf A \times \mathbf A$. <!-- .element: class="fragment" -->


---

<div class="fragment" align="left">
<a style="color:#e7ad52">**Lemma 1**</a>
If $0$, $1 \in U$, if $(0,1) \in \beta - \alpha$, if
$t \in Tail(U)$, then $\beta = Cg(0,1)$ and $\mathbf B$ is generated by $\{0, 1, t\}$.
</div>


---

For $i \leq n$, let $\rho_i = ker (\mathbf B \twoheadrightarrow \mathbf A_i)$, so $\mathbf B \cong \mathbf{A}_i/\rho_i$.

For a subset $\sigma \subseteq \underline{n}$, define
\[
\rho_\sigma := \bigwedge_{j\in \sigma} \rho_j,
\]
so, $\rho_{\underline{n}} = \bigwedge_{j\in \underline{n}}\rho_j = 0_{B}$.


<div class="fragment" align="left">
<a style="color:#e7ad52">**Lemma 2**</a>  
For every $\emptyset \subset \sigma \subset \undreline{n}$,
  either $\beta \leq \rho_\sigma$ or $\alpha \join \rho_\sigma = 1_B$.
</div>


---

<div class="fragment" align="left">
<a style="color:#e7ad52">**Lemma 3**</a>  
  For every proper nonempty subset $\sigma$ of $\nn$,
  for all $v\in B$, and for all $b\in \body(U)$, we have
  $(v,b) \in \beta \circ \rho_\sigma \cap \rho_\sigma \circ \beta$.
</div>

---

<div class="fragment" align="left">
<a style="color:#e7ad52">**Lemma 4**</a>  
  1. There exists $i$ such that $\alpha \join \rho_i = 1_B$
  2. There exists $i$ such that $\alpha \join \rho_i < 1_B$.
</div>

---


For $i \leq n$, let $\rho_i$ 
denote the kernel of the projection of $\mathbf{B}$ onto $\mathbf{A}_i$,
so $\mathbf{B} \cong \mathbf{A}_i/\rho_i$.
For a subset $\sigma \subseteq [n]$, define

$\rho_\sigma := \bigwedge_{j\in \sigma} \rho_j.$

Consequently,

$\rho_{[n]} = \bigwedge_{j\in [n]}\rho_j = 0_{B}$

By minimality of $n$ we know that the intersection of any  proper subset of the $\rho_i$, $1 \leq i \leq n$ is strictly above $0_B$.  Thus, $0_B < \rho_\sigma < 1_B$ for all $\emptyset \subset \sigma\subset [n]$
(by $\subset$ we mean \emph{proper} subset).

---

- For this $n$, select the $\mathbf{A}_i$ and $\mathbf{B}$ so that $|B|$ is as small as possible. <!-- .element: class="fragment" -->
- Let $\alpha \prec \beta$ be a prime quotient of $\mathbf{B}$ of type~2 such that its minimal sets have non-empty tails, and choose $\beta$ minimal with this property. <!-- .element: class="fragment" -->
- By HM, this implies $\beta$ is join irreducible and $\alpha$ is its unique subcover. Let $U$ be an $(\alpha, \beta)$-minimal set. <!-- .element: class="fragment" -->

---

<div class="fragment" align="left">
<a style="color:#e7ad52">Proof Strategy</a>
</div>

- WLOG $\mathbf{B}$ is a subdirect product of a finite subcollection of $\mathcal S$. <!-- .element: class="fragment" -->
- Choose $n$ minimal such that for some $\mathbf{A}_0$, $\dots$, $\mathbf{A}_{n-1}$ in $\mathcal S$, there exists $\mathbf{B} \leq_{sd} \prod_{[n]} \mathbf{A}_i$ with a prime quotient of type 2 whose minimal sets have tails. <!-- .element: class="fragment" -->
- Assuming $n > 1$, we prove that $n = 2$. <!-- .element: class="fragment" -->

---

## Lemma 3.2
  For every proper nonempty subset $\sigma \subset [n]$,
  either $\beta \leq \rho_\sigma$ or $\alpha \vee \rho_\sigma = 1_B$.

## Near Permutability Lemma

For all $\sigma \subset [n]$, all $v\in B$, and all $c\in body(U)$, we have
\begin{equation*}(v,c) \in \beta \circ \rho_\sigma \cap \rho_\sigma \circ \beta.\end{equation*}

## Lemma 3.3

1. There exists $0 \leq i < n$ such that $\alpha \vee \rho_i = 1_B$

2. There exists $i$ such that $\alpha \vee \rho_i < 1_B$.

---

## Theorem 3.4

Let $\mathcal V$ be the variety generated by some finite set $\mathcal S$ of finite,
idempotent algebras that is closed under taking subalgebras. If $\mathcal V$
omits type 1 and some finite member of $\mathcal V$ has a prime quotient 
of type 2 whose minimal sets have non-empty tails, then there is some
3-generated algebra $\mathbf{B}$ with this property that belongs to $\mathcal S$ or 
is a subdirect product of two algebras from $\mathcal S$. 
