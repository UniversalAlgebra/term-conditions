%% FILE: com-fix-poi.tex
%% AUTHORS: William DeMeo
%% DATE: 1 Mar 2017
%% COPYRIGHT: (C) 2017 William DeMeo
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                         BIBLIOGRAPHY FILE                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% The `filecontents` command will crete a file in the inputs directory called 
%% refs.bib containing the references in the document, in case this file does 
%% not exist already.
%% If you want to add a BibTeX entry, please don't add it directly to the
%% refs.bib file.  Instead, add it in this file between the
%% \begin{filecontents*}{refs.bib} and \end{filecontents*} lines
%% then delete the existing refs.bib file so it will be automatically generated 
%% again with your new entry the next time you run pdfaltex.
\begin{filecontents*}{refs.bib}
@article {MR2470585,
    AUTHOR = {Freese, Ralph},
     TITLE = {Computing congruences efficiently},
   JOURNAL = {Algebra Universalis},
  FJOURNAL = {Algebra Universalis},
    VOLUME = {59},
      YEAR = {2008},
    NUMBER = {3-4},
     PAGES = {337--343},
      ISSN = {0002-5240},
   MRCLASS = {08A30 (08A40 68W30 68W40)},
  MRNUMBER = {2470585 (2009j:08003)},
MRREVIEWER = {Clifford H. Bergman},
       DOI = {10.1007/s00012-008-2073-1},
       URL = {http://dx.doi.org/10.1007/s00012-008-2073-1},
}
@article{Bergman-DeMeo-2016,
  author    = {Clifford Bergman and William DeMeo},
  title     = {Universal Algebraic Methods for Constraint Satisfaction Problems},
  journal   = {CoRR},
  volume    = {abs/1611.02867},
  year      = {2016},
  url       = {http://arxiv.org/abs/1611.02867},
  timestamp = {Thu, 01 Dec 2016 19:32:08 +0100},
  biburl    = {http://dblp.uni-trier.de/rec/bib/journals/corr/BergmanD16},
  bibsource = {dblp computer science bibliography, http://dblp.org}
}
@article {MR1663558,
    AUTHOR = {Kearnes, Keith A. and Szendrei, {\'A}gnes},
     TITLE = {The relationship between two commutators},
   JOURNAL = {Internat. J. Algebra Comput.},
  FJOURNAL = {International Journal of Algebra and Computation},
    VOLUME = {8},
      YEAR = {1998},
    NUMBER = {4},
     PAGES = {497--531},
      ISSN = {0218-1967},
   MRCLASS = {08A05 (08A30)},
  MRNUMBER = {1663558},
MRREVIEWER = {M. G. Stone},
       DOI = {10.1142/S0218196798000247},
       URL = {http://dx.doi.org/10.1142/S0218196798000247},
}
@article {MR1257643,
    AUTHOR = {Lipparini, Paolo},
     TITLE = {Commutator theory without join-distributivity},
   JOURNAL = {Trans. Amer. Math. Soc.},
  FJOURNAL = {Transactions of the American Mathematical Society},
    VOLUME = {346},
      YEAR = {1994},
    NUMBER = {1},
     PAGES = {177--202},
      ISSN = {0002-9947},
   MRCLASS = {08B10 (08A30 08B05)},
  MRNUMBER = {1257643},
MRREVIEWER = {H. Peter Gumm},
       DOI = {10.2307/2154948},
       URL = {http://dx.doi.org/10.2307/2154948},
}
@article {MR1145556,
    AUTHOR = {Day, A. and Gumm, H. P.},
     TITLE = {Some characterizations of the commutator},
   JOURNAL = {Algebra Universalis},
  FJOURNAL = {Algebra Universalis},
    VOLUME = {29},
      YEAR = {1992},
    NUMBER = {1},
     PAGES = {61--78},
      ISSN = {0002-5240},
   MRCLASS = {08B10 (08B99)},
  MRNUMBER = {1145556},
MRREVIEWER = {David Hobby},
       DOI = {10.1007/BF01190756},
       URL = {http://dx.doi.org/10.1007/BF01190756},
}
@article {MR541622,
    AUTHOR = {Hagemann, Joachim and Herrmann, Christian},
     TITLE = {A concrete ideal multiplication for algebraic systems and its
              relation to congruence distributivity},
   JOURNAL = {Arch. Math. (Basel)},
  FJOURNAL = {Archiv der Mathematik. Archives of Mathematics. Archives
              Math\'ematiques},
    VOLUME = {32},
      YEAR = {1979},
    NUMBER = {3},
     PAGES = {234--245},
      ISSN = {0003-889X},
   MRCLASS = {08B10},
  MRNUMBER = {541622},
MRREVIEWER = {Ralph Freese},
       DOI = {10.1007/BF01238496},
       URL = {http://dx.doi.org/10.1007/BF01238496},
}
@book {MR0432511,
    AUTHOR = {Smith, Jonathan D. H.},
     TITLE = {Mal$\prime$cev varieties},
    SERIES = {Lecture Notes in Mathematics, Vol. 554},
 PUBLISHER = {Springer-Verlag, Berlin-New York},
      YEAR = {1976},
     PAGES = {viii+158},
   MRCLASS = {08A15},
  MRNUMBER = {0432511},
MRREVIEWER = {V. A. Artamonov},
}
@article {MR590312,
    AUTHOR = {Gumm, H.-Peter},
     TITLE = {An easy way to the commutator in modular varieties},
   JOURNAL = {Arch. Math. (Basel)},
  FJOURNAL = {Archiv der Mathematik. Archives of Mathematics. Archives
              Math\'ematiques},
    VOLUME = {34},
      YEAR = {1980},
    NUMBER = {3},
     PAGES = {220--228},
      ISSN = {0003-889X},
   MRCLASS = {08B10},
  MRNUMBER = {590312},
MRREVIEWER = {Alden Pixley},
       DOI = {10.1007/BF01224955},
       URL = {http://dx.doi.org/10.1007/BF01224955},
}
@article {MR1358491,
    AUTHOR = {Kearnes, Keith A.},
     TITLE = {Varieties with a difference term},
   JOURNAL = {J. Algebra},
  FJOURNAL = {Journal of Algebra},
    VOLUME = {177},
      YEAR = {1995},
    NUMBER = {3},
     PAGES = {926--960},
      ISSN = {0021-8693},
     CODEN = {JALGA4},
   MRCLASS = {08B10 (08B05)},
  MRNUMBER = {1358491},
MRREVIEWER = {H. Peter Gumm},
       DOI = {10.1006/jabr.1995.1334},
       URL = {http://dx.doi.org/10.1006/jabr.1995.1334},
}
\end{filecontents*}
%% \documentclass[reqno]{au}
\documentclass{au}
% The following \documentclass options may be useful:
% preprint      Remove this option only once the paper is in final form.
% 10pt          To set in 10-point type instead of 9-point.
% 11pt          To set in 11-point type instead of 9-point.
% numbers       To obtain numeric citation style instead of author/year.

%% \usepackage{setspace}\onehalfspacing

\usepackage{amsmath}
%% \usepackage{wasysym}
\usepackage{amscd,amssymb,amsthm} %, amsmath are included by default
\usepackage{latexsym,mathrsfs,enumerate,scalefnt,ifthen}
\usepackage{stmaryrd}
\SetSymbolFont{stmry}{bold}{U}{stmry}{m}{n}
\usepackage{mathtools}
\usepackage[mathcal]{euscript}
\usepackage[colorlinks=true,urlcolor=black,linkcolor=black,citecolor=black]{hyperref}
\usepackage{url}
\usepackage{scalefnt}
\usepackage{tikz}
\usepackage{color}
\usepackage[margin=1in]{geometry}
\usepackage{scrextend}
\usepackage{comment}

%%////////////////////////////////////////////////////////////////////////////////
%% Theorem styles
\numberwithin{equation}{section}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{prop}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{Fact}[theorem]{Fact}
\newtheorem*{fact}{Fact}
\newtheorem{example}[theorem]{Example}
\newtheorem{examples}[theorem]{Examples}
\newtheorem{exercise}{Exercise}
\newtheorem*{lem}{Lemma}
\newtheorem*{cor}{Corollary}
\newtheorem*{remark}{Remark}
\newtheorem*{remarks}{Remarks}
\newtheorem*{obs}{Observation}

\newcommand{\Phiba}{\ensuremath{\Phi_{\beta, \alpha}}}
\newcommand{\Psiba}{\ensuremath{\Psi_{\beta, \alpha}}}
\newcommand{\Deltaba}{\ensuremath{\Delta_{\beta, \alpha}}}
\newcommand{\Deltabar}{\ensuremath{\mathrel{\Delta_{\beta, \alpha}}}}
%% \newcommand{\Phiba}{\ensuremath{\Phi}}
%% \newcommand{\Psiba}{\ensuremath{\Psi}}
\newcommand{\thetaba}{\ensuremath{\theta_{\beta, \alpha}}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Acronyms
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% \usepackage[acronym, shortcuts]{glossaries}
%\usepackage[smaller]{acro}
\usepackage[smaller]{acronym}
\usepackage{xspace}

%% \acs{CSP} -- short version of the acronym\\
%% \acl{CSP} -- expanded acronym without mentioning the acronym.\\
%% \acp{CSP} -- plurals.\\
%% \acfp{CSP} -- long forms into plurals.\\
%% \acsp{CSP} -- short form into a plural.\\
%% \aclp{CSP} -- long form into a plural.\\
%% \acfi{CSP} -- Full Name acronym in italics and abbreviated form in upshape.\\
%% \acsu{CSP} -- short form of the acronym and marks it as used.\\
%% \aclu{CSP} -- Prints the long form of the acronym and marks it as used.\\

\acrodef{lics}[LICS]{Logic in Computer Science}
\acrodef{sat}[SAT]{satisfiability}
\acrodef{nae}[NAE]{not-all-equal}
\acrodef{ctb}[CTB]{cube term blocker}
\acrodef{tct}[TCT]{tame congruence theory}
\acrodef{wnu}[WNU]{weak near-unanimity}
\acrodef{CSP}[CSP]{constraint satisfaction problem}
\acrodef{MAS}[MAS]{minimal absorbing subuniverse}
\acrodef{MA}[MA]{minimal absorbing}
\acrodef{cib}[CIB]{commutative idempotent binar}
\acrodef{sd}[SD]{semidistributive}
\acrodef{NP}[NP]{nondeterministic polynomial time}
\acrodef{P}[P]{polynomial time}
\acrodef{PeqNP}[P $ = $ NP]{P is NP}
\acrodef{PneqNP}[P $ \neq $ NP]{P is not NP}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% \usepackage{inputs/proof-dashed}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%% Put new macros in the macros.sty file
\usepackage{inputs/macros}

\begin{document}

%% \title[Computing the Commutator Efficiently]{Computing the commutator efficiently}
\title{The Commutator as Least Fixed Point of a Closure Operator}
\date{\today}
\author[W.~DeMeo]{William DeMeo}
\address{University of Hawaii}
\email{williamdemeo@gmail.com}

%% \thanks{The authors would like to extend special thanks to...}

\renewcommand{\etaR}{\ensuremath{\eta}}

%% \begin{abstract}
%% This note provides some tools that should enable us to prove
%% the following: if $\bA$ is a finite idempotent algebra with a
%% difference term operation, then the 2-generated free algebra in $\bbV(\bA)$ has
%% a difference term operation.  
%% \end{abstract}

%% \renewcommand{\bbeta}{\ensuremath{\ubar{\boldsymbol{\beta}}}}

\begin{abstract}
  We present a description of the commutator that is inspired by that of
  Kearnes in~\cite[p.~930]{MR1358491} and leads to
  a simple procedure for computing the commutator.
  
  %% (here $\beta$ is a congruence of $\bA$ and $\bA \times_\beta \bA$ denotes the subalgebra of
  %% $\bA^2$ with universe $\beta$):
  %% \begin{quote}
  %% %% ``When $\alpha$ and $\beta$ are reflexive, compatible relations
  %% %% First, when $\beta$ is a reflexive, compatible binary relation on $A$
  %% %% we...
  %% ``Let $\Delta_{\beta,\alpha}$ be the congruence on $\bA \times_\beta \bA$ generated by
  %% \[\{\<(x, x), (y, y)\> \mid (x, y) \in \alpha\}.\]
  %% Call a subset $G \subseteq A^2$ {\bf $\Delta$-closed} if
  %% \[
  %% \Delta_{\beta,\alpha}\circ G \circ \Delta_{\beta,\alpha} \subseteq G.
  %% \]
  %% When $\alpha$ and $\beta$ are reflexive, compatible relations, then $[\alpha, \beta]$
  %% is the smallest subset $\gamma \subseteq A^2$ such that (i) $\gamma$
  %% is a congruence of $\bA$ and (ii) $\gamma$ is $\Delta$-closed.''
  %% \end{quote}
\end{abstract}

\maketitle

%% \renewcommand\otimes{\ensuremath{\mathrel{\bullet}}}
\renewcommand\otimes{\ensuremath{\ast}}
\section{Preliminaries}
%% The genesis of these notes was my attempt to interpret the expression 
%% $\Delta_{\beta,\alpha}\circ G \circ \Delta_{\beta,\alpha}$.
%% Noting that 
%% $\Delta_{\beta,\alpha} \subseteq (A\times A)^2$ while
%% $G\subseteq A^2$, a standard means of composing 
%% relations such as these, with different arities, was not immediately apparent.
%% In this note I give one possible interpretation
%% of Keith's ``useful alternate description of $[\alpha, \beta]$.''
%% The commutator is a fixed point
%% (i.e., closed set) of a certain closure operator
%% involving the relation $\Delta_{\beta, \alpha}$ defined above.

%% \subsection{Notation and Definitions}
%% \label{sec:defs}
If $A$ and $B$ are sets and  $\alpha \subseteq A\times A$ and $\beta \subseteq B\times B$
are binary relations on $A$ and $B$, respectively, then 
we define
%% let $\alpha \otimes \beta$ denote the
the \emph{pairwise product} of $\alpha$ and $\beta$ by
\begin{equation}
\label{eq:pair-product}
\alpha \otimes \beta = \{((a, b), (a', b')) 
\in (A\times B)^2 \mid a\mathrel{\alpha} a'\, \text{ and } \,  b\mathrel{\beta} b'\},
\end{equation}
and we let $\alpha \times \beta$ denote the usual Cartesian product of sets; that is,
%% of the sets $\alpha$ and $\beta$, that is,
\begin{equation}
\label{eq:set-product}
\alpha \times \beta = \{((a, a'), (b, b')) 
\in A^2\times B^2 \mid a\mathrel{\alpha} a' \, \text{ and } \, b\mathrel{\beta} b'\}.
\end{equation}
%% Notice that $\alpha \otimes \beta$ defines an equivalence relation on
%% $A\times B$, whereas in general $\alpha\times \beta$ is 
%% not even a binary relation on a single set.
The equivalence class of $\alpha \otimes \beta$ containing the pair
$(a, b)$ is denoted and defined by % \in A\times B$ is
\[(a,b)/(\alpha \otimes \beta) = a/\alpha \times b/\beta= 
    \{(a', b') \in A\times B \mid a\mathrel{\alpha} a' \, \text{ and } \,  b\mathrel{\beta} b'\},
    \]
the Cartesian product of the sets $a/\alpha$ and $b/\beta$.
The set of all equivalence classes of $\alpha \otimes \beta$ is also a Cartesian product, namely,
$(A\times B)/(\alpha \otimes \beta) =
A/\alpha \times B/\beta  = \{(a, b)/(\alpha \otimes \beta) \mid a\in A \, \text{ and } \, b \in B\}$.
%% \begin{remarks}\
%%   \begin{enumerate}
%%   \item The equivalence relations $\alpha$ and $\beta$ are subsets
%%     of $A^2$ and $B^2$, respectively, so it might seem more natural to interpret 
%%     $\alpha \times \beta$ as a subset of $A^2 \times B^2$. Nonetheless, in this 
%%     context it is usually more convenient to arrange the coordinates 
%%     so that $\alpha \times \beta \subseteq (A \times B)^2$, as in
%%     item~(\ref{item:9}).
%%   \end{enumerate}
%% \end{remarks}

For an algebra $\bA$ with congruence relations $\alpha$, $\beta\in \Con\bA$,
let $\bbeta$ denote the subalgebra of $\bA\times \bA$ with universe 
$\beta$, and let $0_A$ denote the least equivalence relation on $A$.
%% (note that $0_A$ is a subuniverse of $\bbeta$).
Thus, $0_A = \{(a,a) \mid a\in A\} \leq \beta$.
Denote by $D_\alpha$ the following subset of $\beta \times \beta$:
\begin{equation}
  \label{eq:9009}
D_\alpha =(\alpha \otimes \alpha) \cap (0_A \times 0_A)
= \{((a,a), (b,b)) \in (0_A \times 0_A) \mid a\alphar b\}.
\end{equation}
Let $\Delta_{\beta, \alpha} = \Cg^{\bbeta}(D_\alpha)$ denote the congruence relation
of $\bbeta$ generated by $D_\alpha$.
%% \end{align}
%% \begin{align}
%%   D_\alpha&:=(\alpha \otimes \alpha) \cap (0_A \times 0_A)
%%   = \{((a,a), (b,b)) \in (0_A \times 0_A) \mid a\alphar b\}, \text{ and }\\
%% \Delta_{\beta, \alpha} &:= \Cg^{\bbeta}(D_\alpha),
%% \end{align}
%% That is, \Delta_{\beta, \alpha} is the congruence on $\bbeta$ generated by the set $D^2_\alpha$.
%% As usual, the congruence class of $\Delta_{\beta, \alpha}$ that contains
%% $(b,b')$ is denoted and defined by 
%% \[
%% (b,b')/\Delta_{\beta,\alpha} = \{(a,a') \in \beta \mid (a,a') \mathrel{\Delta_{\beta,\alpha}} (b,b')\}.
%% \]
The condition $\CC{\alpha}{\beta}{\gamma}$
holds iff for all $a \alphar b$, for all $u_i \betar v_i$ ($1\leq i\leq n$), and for all 
$t\in \Pol_{n+1}(\bA)$, we have
%% $t(a,\bu) \mathrel{[\alpha, \beta]} t(a, \bv)$
%% iff $t(b,\bu) \mathrel{[\alpha, \beta]} t(b, \bv)$.
$t(a,\bu) \mathrel{\gamma} t(a, \bv)$
iff $t(b,\bu) \mathrel{\gamma} t(b, \bv)$.
There are a number of different ways to define a commutator.
See, for example,~\cite{MR0432511,MR541622,MR590312,MR1145556,MR1663558}.
In this note, the commutator $[\alpha, \beta]$ is defined to be the least
congruence $\gamma$ such that $\CC{\alpha}{\beta}{\gamma}$ holds.
\begin{comment}
Occasionally it is more convenient to write such an equivalence as a (two-way) derivation tree,
as follows:
\[
\infer=[\CC{\alpha}{\beta}{\gamma}]{\Gamma \vdash t(b,\bu) \mathrel{\gamma} t(b, \bv)}{\Gamma \vdash t(a,\bu) \mathrel{\gamma} t(a, \bv)}\]
where $\Gamma$ is a context containing
$a \alphar b$, $u_i \betar v_i$ ($1\leq i\leq n$), and 
$t\in \Pol_{n+1}(\bA)$.
\end{comment}

\renewcommand{\downbeta}{\ensuremath{\lb 0_A, \beta\rb}}


%%%%%%%%%%%%%%%%%%%%%% BEGIN: omitted stuff
\begin{comment}

Where convenient we will resort to denoting pairs, and pairs of pairs, using arrays instead of tuples, and tuples of tuples, etc. That is, 
\[
\begin{bmatrix} x \\ y \end{bmatrix} = (x,y) \quad
\text{ and } \quad 
\begin{bmatrix} x & x'\\y & y' \end{bmatrix} = ((x,y), (x', y')).
\]


%% \begin{equation}
%%   \label{eq:3}
%%   \Delta_{\alpha, \beta} \circ \gamma^2 \circ \Delta_{\alpha, \beta} =
%%   \{\bigl((x,x),(y,y)\bigr) \mid \bigl(\exists (a,b) \in \gamma \bigr) \,
%%   (x,x) \mathrel{\Delta_{\alpha, \beta}} (a,a)\, \text{ and } \,
%%   (b,b) \mathrel{\Delta_{\alpha, \beta}} (y,y)\}.
%% \end{equation}
\begin{equation}
  \label{eq:3}
  \Delta_{\alpha, \beta} \circ (\gamma \ast \gamma) \circ \Delta_{\alpha, \beta} =
  \left\{
  \begin{bmatrix} x & x'\\y & y' \end{bmatrix}
  %% \left(
  %% \begin{pmatrix} x\\y \end{pmatrix},
  %% \begin{pmatrix} x'\\y' \end{pmatrix}
  %% \right)
  \,\middle|\,
  (\exists a, b, a', b') \,
  \begin{bmatrix} x\\y \end{bmatrix}
  \mathrel{\Delta_{\alpha, \beta}}
  \begin{bmatrix} a\\b \end{bmatrix}
  \mathrel{(\gamma\otimes \gamma)}
  \begin{bmatrix} a'\\b' \end{bmatrix}
  \mathrel{\Delta_{\alpha, \beta}}
  \begin{bmatrix} x'\\y' \end{bmatrix}\right\}
\end{equation}
We call an equivalence relation $\theta\in \Eq(A)$ ``$\Delta_{\beta,\alpha}$-closed'' if
it is closed with respect to the relation~(\ref{eq:3}).
More precisely, we will say that $\theta$ is \emph{$\Delta_{\beta,\alpha}$-closed} if
$((x,y),(x',y')) \in \Delta_{\alpha, \beta} \circ (\theta\ast \theta)
\circ \Delta_{\alpha, \beta}$
implies $(x,x') \in \theta$ and $(y,y') \in \theta$.

In~\cite[p.~930]{MR1358491}, Kearnes describes the 
commutator as the least $\gamma\in \Con (\bA)$ that is ``$\Delta_{\beta,\alpha}$-closed.''
%% $\Delta_{\alpha, \beta} \circ \gamma^2 \circ \Delta_{\alpha, \beta}$; that is, closed under the following relation:
Although there is no proof in~\cite[p.~930]{MR1358491} demonstrating that this
is an apt description of the commutator, the justification probably uses
the fact that the term condition
$\CC{\alpha}{\beta}{\gamma}$ implies 
the following derivation\footnote{In this notation, the stuff below the horizontal line
  is a consequence of the stuff above the horizontal line.}
%% \[
%%   \begin{bmatrix} t(b,\bu) \\ t(b,\bu)  \end{bmatrix}
%%   \mathrel{\Delta_{\alpha, \beta}}
%%   \begin{bmatrix} t(a,\bu) \\ t(a,\bu)  \end{bmatrix}
%%   \mathrel{\gamma^2}  %% \mathrel{[\alpha, \beta]^2} 
%%   \begin{bmatrix} t(a,\bv) \\ t(a,\bv)  \end{bmatrix}
%%   \mathrel{\Delta_{\alpha, \beta}}
%%   \begin{bmatrix} t(b,\bv) \\ t(b,\bv)  \end{bmatrix}}
%%   \begin{bmatrix} t(b,\bu) \\ t(b,\bu)  \end{bmatrix}
%%   \mathrel{\Delta_{\alpha, \beta}}
%%   \begin{bmatrix} t(a,\bu) \\ t(a,\bu)  \end{bmatrix}
%%   \mathrel{[\alpha, \beta]^2}    %% \mathrel{[\alpha, \beta]^2} 
%%   \begin{bmatrix} t(a,\bv) \\ t(a,\bv)  \end{bmatrix}
%%   \mathrel{\Delta_{\alpha, \beta}}
%%   \begin{bmatrix} t(b,\bv) \\ t(b,\bv)  \end{bmatrix}}
%% $\CC{\alpha}{\beta}{\gamma}$ holds iff is the following:Therefore, 
\[
\infer{\begin{bmatrix} t(b,\bu) \\ t(b,\bu)  \end{bmatrix}
  \mathrel{(\gamma \ast \gamma)} %% \mathrel{[\alpha, \beta]^2} 
  \begin{bmatrix} t(b,\bv) \\ t(b,\bv)  \end{bmatrix}}
{\begin{bmatrix} t(b,\bu) \\ t(b,\bu)  \end{bmatrix}
  \mathrel{\Delta_{\alpha, \beta}}
  \begin{bmatrix} t(a,\bu) \\ t(a,\bu)  \end{bmatrix}
  \mathrel{(\gamma \ast \gamma)}  %% \mathrel{[\alpha, \beta]^2} 
  \begin{bmatrix} t(a,\bv) \\ t(a,\bv)  \end{bmatrix}
  \mathrel{\Delta_{\alpha, \beta}}
  \begin{bmatrix} t(b,\bv) \\ t(b,\bv)  \end{bmatrix}}
\]


Define
\begin{equation}
  \label{eq:6}
  \Phi_{\beta, \alpha}(\theta)
  = \{ (x,y) \in A^2 \mid
  (\exists\, (a,b) \in \theta)\,
\bigl(  (x,x) \mathrel{\Delta_{\beta, \alpha}} (a,a) \text{ and }
  (b,b) \mathrel{\Delta_{\beta, \alpha}} (y,y)\bigr)\}.
\end{equation}
It seems to me the statement ``$\gamma$ is
$\Delta_{\beta, \alpha}$-closed'' is equivalent to 
$\Phi_{\beta,\alpha}(\gamma)\subseteq \gamma$. However, it's not clear to me
that the commutator should
satisfy
$\Phi_{\beta,\alpha}\bigl([\alpha, \beta]\bigr) \subseteq [\alpha, \beta]$.


\end{comment}
%%%%%%%%%%%%%%%%%%%%%% END: omitted stuff


\section{Alternate Description of the Commutator}
\label{sec:altern-descr}

We now %% In~\cite{com-fix-poi} we gave 
describe an alternate way to express the commutator---specifically,
it is the least fixed point of a certain closure operator.
This description was inspired by the one that is mentioned in passing by
Keith Kearnes in~\cite[p.~930]{MR1358491}.  Our objective here is
to prove that the description we present is correct (i.e., describes the commutator)
and to show that it leads to a simple, efficient procedure for computing the commutator.

Let $\Tol(A)$ denote the collection of all tolerances (reflexive symmetric relations)
on the set $A$,\footnote{Actually, a
  \emph{tolerance} of an algebra $\bA = \<A, \dots\>$
  is a reflexive symmetric subalgebra of $\bA \times \bA$.
  Therefore, the set of all tolerances of $\bA$ forms an
  algebraic (hence complete) lattice.
  If we drop the operations and consider only the set $A$, then a tolerance relation on $A$
  is simply a reflexive symmetric binary relation.
}
and let %% $\downbeta$ denote the set $\{\theta \in \Tol(A) \mid 0_A \leq \theta \leq \beta\}$ 
%% of the tolerances on $A$ contained in $\beta$.
%% Let $\Psi_{\beta, \alpha} \colon \downbeta\to \downbeta$ be the function defined
$\Psi_{\beta, \alpha} \colon \Tol(A) \to \Tol(A)$ be the function defined
for each $T \in  \Tol(A)$ follows:
%% \footnote{Actually, in~\cite{com-fix-poi}
%% I define %$\Phi_{\beta, \alpha} \colon \sP(\beta) \to \sP(\beta)$ as follows:
%% \begin{equation*}
%%   \Phi_{\beta, \alpha}(B) = \bigcup_{(b,b')\in B} (b,b')/\Delta_{\beta, \alpha},
%% \end{equation*}
%% and allegedly proved that the commutator $[\alpha, \beta]$ is the least fixed point
%% of $\Phi_{\beta, \alpha}$.
%% I haven't found a mistake in that proof, but I have found reasons to
%% suspect a problem with it.  This is why I revised the claim in the present note
%% using the function $\Psiba$ instead.}
%% \begin{equation}
%%   \label{eq:7}
%%   \Psi_{\beta, \alpha}(\theta)
%%   = \{ (x,y) \in A\times A \mid
%%   \bigl(\exists\, (a,b) \in \theta\big)\,
%%  (a,b) \mathrel{\Delta_{\beta, \alpha}} (x,y)\},
%% \end{equation}
\begin{equation}
  \label{eq:7}
  \Psi_{\beta, \alpha}(T)
  = \{ (x,y) \in A\times A \mid
  (\exists\, (a,b) \in T)\,
 (a,b) \mathrel{\Delta_{\beta, \alpha}} (x,y)\},
\end{equation}
where
$\Delta_{\beta, \alpha} = \Cg^{\bbeta}(D_\alpha)$ and
$D_\alpha =(\alpha \otimes \alpha) \cap (0_A \times 0_A)$
(as in~(\ref{eq:9009})).
%% We will prove below that the commutator $[\alpha, \beta]$ is the least fixed
%% point of $\Psiba$.
%% Since $\Psiba$ is clearly monotone increasing and since the collection of tolerances
%% of $A$ is an algebraic (hence complete) lattice,
%% $\Psiba$ has a least fixed point.

\pagebreak[2]
\begin{remarks}\
  \begin{enumerate}
\item
  It's easy to see that $\Psiba (T)$ is reflexive and symmetric
  whenever $T$ has these properties; similarly, $\Psiba (T)$ is compatible with the
  operations of $\bA$ whenever $T$ is. In other words $\Psiba$ maps tolerances of
  $A$ ($\bA$, resp.) to tolerances of $A$ ($\bA$, resp.).
  %% If $T$ happens to be transitive as well, then
  %% $\Psiba (T)$ is also transitive; proof: let
  %% $(x,y), (y,z) \in \Psiba (T)$.  Then there exists $(a,b)\in T$ and $(c,d) \in T$ such that
  %% $(a,b) \Detalbar (x,y)$ and
  %% $(c,d) \Detalbar (y,z)$.
  \item 
  Since $\Psiba$ is clearly a monotone increasing function on the complete
  lattice $\Tol(A)$, it is guaranteed to have a least fixed
  point---that is, there is a point $\tau\in \Tol(A)$ such that $\Psiba(\tau) = \tau$
  and $\tau \leq T$, for every $T \in \Tol(A)$
  satisfying $\Psiba(T) = T$.
\item
  Here are two ways the least fixed point of $\Psiba$ could be computed:
  \begin{equation}
    \label{eq:4}
  \tau = \Meet \{ T \in \Tol(A) \mid \Psiba(T) \leq T\}
  \quad \text{ and } \quad
     \tau = \Join_{k\geq 0} \Psiba^{k}(0_A).
  \end{equation}
  In Lemma~\ref{lem:fixed-point-comm} we will show that the least
  fixed point of $\Psiba$ is, in fact, the commutator,
  $\tau = [\alpha, \beta]$, so either
  expression in~(\ref{eq:4}) could potentially be used to compute it.
  %% For example,
  %% an algorithm might be based on the following formula:
  %% \begin{equation}
  %%   \label{eq:5}
  %%         [\alpha, \beta] = \Join_{k\geq 0} \Psiba^{k}(0_A).
  %% \end{equation}
  However, Lemma~\ref{lem:fixed-point-comm} also shows that 
  $\Psiba$ is a closure operator; in particular, it is idempotent. Therefore,
  $\Psiba^{k}(0_A) = \Psiba(0_A)$ for all $k$, so we have 
  the following simple description of the commutator:
  \begin{align*}
    %% \label{eq:55}
          [\alpha, \beta] =
          \Psiba(0_A)
          &= \{ (x,y) \in A\times A \mid
          (\exists\, (a,b) \in 0_A)\, (a,b) \mathrel{\Delta_{\beta, \alpha}} (x,y)\}\\
          &= \{ (x,y) \in A\times A \mid
          (\exists a \in A)\, (a,a) \mathrel{\Delta_{\beta, \alpha}} (x,y)\}.
  \end{align*}

  %(See, for example,~\cite{MR3012378}.)

  %% Recall, if $f$ is a monotone increasing function defined on a
  %%   complete poset $\<P, \leq\>$, then the least fixed point of $f$
  %%   is $\Meet \{ p\in P \mid f p \leq p\}$. %(See, for example,~\cite{MR3012378}.)
  %%   Thus,
  %%   Lemma~\ref{lem:fixed-point-comm}~(\ref{item:2}) asserts that
  %%   \begin{equation}
  %%     \label{eq:2}
  %%           [\alpha, \beta] =\Meet \{ B \subseteq \beta \mid \Psiba(B) \subseteq B\}.
  %%   \end{equation}
  \end{enumerate}
\end{remarks}


\subsection{Fixed Point Lemma}
\begin{lemma}
  \label{lem:fixed-point-comm}
  If $\alpha$, $\beta\in \Con(\bA)$ and 
  if $\Psi_{\beta, \alpha}$ is defined by~(\ref{eq:7}), then 
  \begin{enumerate}[(i)]
  \item \label{item:1} $\Psiba$ is a closure operator on $\Tol(A)$;
  \item \label{item:2} $[\alpha, \beta]$ is the least fixed point of $\Psiba$.
  \end{enumerate}
\end{lemma}
\begin{proof}\
  \begin{enumerate}[(i)]
  \item 
  %% In fact, $\Psi_{\beta, \alpha}$ is a closure operator on all
  %% of $\Tol(A)$ as we 
    To prove (i) we verify that
    $\Psi_{\beta, \alpha}$ has the three properties that define a closure
    operator---namely for all $T$, $T' \in \Tol(A)$,
  \begin{enumerate}[(c.1)]
  \item \label{item:c1} $T  \leq \Psiba(T )$;     
  \item \label{item:c2} $T  \leq T'  \Rightarrow \Psiba(T) \leq \Psiba(T')$;    
  \item \label{item:c3} $\Psiba(\Psiba(T))  = \Psiba(T)$. 
  \end{enumerate}

  \vskip2mm

  \noindent {\it Proof of (c.1):} $(a,b) \in T $
  implies $(a,b) \in \Psiba(T )$ because $(a,b)\mathrel{\Delta_{\beta, \alpha}} (a,b)$.\\[4pt]
  %% this proves~(c.\ref{item:c1}).
  \noindent {\it Proof of (c.2):} $(x,y) \in \Psiba(T )$ iff there exists
  $(a,b) \in T  \leq T'$ such that
  $(a,b) \mathrel{\Delta_{\beta, \alpha}} (x,y)$; this and $(a,b) \in T'$ implies
  $(x,y) \in \Psiba(T')$.\\[4pt]
  \noindent {\it Proof of (c.3):} $(x,y) \in \Psiba(\Psiba(T))$ if and only if
  there exists $(a,b) \in \Psiba(T)$ such that
  $(a,b) \Deltabar (x,y)$, and $(a,b) \in \Psiba(T)$ is in turn equivalent to 
  the existence of $(c,d) \in T $ such that
  $(c,d) \Deltabar (a,b)$. By transitivity of $\Deltaba$, we have that
  $(c,d) \Deltabar (a,b) \Deltabar (x,y)$ implies
  $(c,d) \Deltabar (x,y)$, proving that there exists $(c,d) \in T $ such that
  $(c,d) \Deltabar (x,y)$; equivalently, $(x,y) \in T $.

  \medskip

\item
  %% \noindent (ii) 
  As remarked above, from part (i) follows 
  $\Psiba^{k}(0_A) = \Psiba(0_A)$ for all $k$, so the least fixed point of
  $\Psiba$ that appears in the formula on the right in~(\ref{eq:4}) reduces
  to $\tau = \Psiba(0_A)$.  Therefore, to complete the proof it suffices to show
  $[\alpha, \beta] = \Psiba(0_A)$.
  %% An alternative direct proof using
  %% \malcev's congruence generation theorem appears in the appendix Section
  %% below.
  %% [\alpha, \beta] = \Join_{k\geq 0} \Psiba^{k}(0_A).


  We first prove $[\alpha, \beta]\leq \Psiba(0_A)$.
  Since $[\alpha, \beta]$ is the least congruence $\gamma$
  satisfying $\CC{\alpha}{\beta}{\gamma}$, it suffices to prove
    $\CC{\alpha}{\beta}{\Psiba(0_A)}$ holds.
    Suppose $a \alphar a'$ and $b_i \betar b_i'$ %% ($1\leq i \leq k$)
    and $t^{\bA} \in \Pol_{k+1}(\bA)$ satisfy
    $t^{\bA}(a, \bb) \mathrel{\Psiba(0_A)} t^{\bA}(a, \bb')$,
    where $\bb = (b_1, \dots, b_k)$ and $\bb' = (b_1', \dots, b_k')$.
    We must show $t(a', \bb) \mathrel{\Psiba(0_A)} t(a', \bb')$.  
    By definition of $\Psiba$,
    the antecedent $t^{\bA}(a, \bb) \mathrel{\Psiba(0_A)} t^{\bA}(a, \bb')$ is equivalent to    
    the existence of $c \in A$ such that $(c,c) \Deltabar (t^{\bA}(a, \bb), t^{\bA}(a, \bb'))$.
    Now
    \[
    (t^{\bA}(a, \bb), t^{\bA}(a, \bb')) = t^{\bbeta}((a,a),(b_1, b_1'), \dots,(b_k, b_k')),
    \]
    and since $a \alphar a'$, we have
    \[
    t^{\bbeta}((a,a),(b_1, b_1'), \dots,(b_k, b_k'))
    \Deltabar
    t^{\bbeta}((a',a'),(b_1, b_1'), \dots,(b_k, b_k')).
    \]
    The latter is equal to $(t^{\bA}(a', \bb), t^{\bA}(a', \bb'))$, and  it follows
    by transitivity of $\Deltaba$ that
    $(c,c) \Deltabar (t^{\bA}(a', \bb), t^{\bA}(a', \bb'))$.
    Therefore, $t(a', \bb) \mathrel{\Psiba(0_A)} t(a', \bb')$, as desired.  



  We now prove $\Psiba(0_A)\leq   [\alpha, \beta]$.
  %% \begin{equation}
  %%   \label{eq:8}
  %% \Join_{k\geq 0} \Psiba^{k}(0_A)\leq   [\alpha, \beta].
  %% \end{equation}
  If $(x,y)\in \Psiba(0_A)$ then there exists $a \in A$ such that 
  \begin{equation}
    \label{eq:1100}
    (a,a) \mathrel{\Delta_{\beta, \alpha}} (x,y).
  \end{equation}
  From the definition of $\Delta_{\beta, \alpha}$ and 
  \malcev's congruence generation theorem,~(\ref{eq:1100})
  holds if and only if for there exist
  $(z_i, z_i') \in \beta$ ($0\leq i \leq n+1$), and $(u_i, v_i) \in \alpha$,
  $f_i \in \Pol_1(\bbeta)$ ($0\leq i \leq n$), such that
  $(a, a) = (z_0,z_0')$ and $(x, y)=(z_{n+1},z'_{n+1})$ hold, and so do the
  following equations of sets: 
  \begin{align}
    \label{eq:001}
    \{(a, a),(z_1,z_1')\} &= \{f_0(u_0,u_0), f_0(v_0,v_0)\},\\
    \label{eq:011}
    \{(z_1,z_1'),(z_2,z_2')\} &= \{f_1(u_1,u_1), f_1(v_1,v_1)\},\\
    \nonumber
    &\; \; \vdots\\
    %% \label{eq:n-1}
    \nonumber
    %% \{(z_{n-1},z_{n-1}'),(x, y)\} &= \{f_{n-1}(u_{n-1},u_{n-1}), f_{n-1}(v_{n-1},v_{n-1})\}.
    \{(z_{n},z_{n}'),(x, y)\} &= \{f_{n}(u_{n},u_{n}), f_{n}(v_{n},v_{n})\}.
  \end{align}
  Now $f_i \in \Pol_1(\bbeta)$ for all $i$, so
  \newcommand\gA{\ensuremath{g^{\bA}}}%
  \[
  f_i(c, c') = g_i^{\bbeta}((c, c'), (b_1, b_1'), \dots, (b_k, b_k') )
  = (\gA_i(c, \bb), \gA_i(c', \bb')),%
  \]
  \renewcommand\gA{\ensuremath{g}}%
  for some $k$, some $(k+1)$-ary term $\gA_i$, and some constants
  $\bb = (b_1, \dots, b_k)$ and $\bb' = (b_1', \dots, b_k')$ satisfying
  $b_i \betar b_i'$ ($1\leq i\leq k$). 
  By~(\ref{eq:001}), either
  \[
  (a, a) = \bigl(\gA_0(u_0, \bb), \gA_0(u_0, \bb')\bigr)
  \quad \text{ and } \quad 
  (z_1,z_1')= \bigl(\gA_0(v_0, \bb), \gA_0(v_0, \bb')\bigr),
  \]
  or vice-versa. %Of course $(a, a) \in \comm{\alpha}{\beta}$,
  We assumed $u_0 \alphar v_0$ and $b_i \betar b_i'$ ($1\leq i\leq k$),
  so the $\alpha,\beta$-term condition entails
  $\gA_0(u_0, \ba) \commr{\alpha}{\beta} \gA_0(u_0, \ba')$
  iff 
  $\gA_0(v_0, \ba) \commr{\alpha}{\beta} \gA_0(v_0, \ba')$.
  %% \[
  %%   \gA_0(u_0, \bb) \commr{\alpha}{\beta} \gA_0(u_0, \bb')
  %%   \quad \Longleftrightarrow \quad 
  %%   \gA_0(v_0, \bb) \commr{\alpha}{\beta} \gA_0(v_0, \bb').
  %%   \]
  From this and~(\ref{eq:001}) we deduce that 
  $(a,a)\in [\alpha, \beta]$ iff $(z_1,z_1')\in [\alpha, \beta]$.
  Similarly~(\ref{eq:011}) and $u_1 \alphar v_1$ imply
  $(z_1,z_1')\in [\alpha, \beta]$ iff
  $(z_2,z_2')\in [\alpha, \beta]$.  Inductively, and by transitivity of
  $[\alpha, \beta]$, we conclude $(a,a)\in [\alpha, \beta]$ iff
  $(x,y)\in [\alpha, \beta]$.
  Since $(a,a)\in [\alpha, \beta]$, we have $(x,y)\in [\alpha, \beta]$, as desired.

  \end{enumerate}
\end{proof}

\section{Computing the Commutator}
As a consequence of the description of the commutator given in the last section,
we now have the following simple method for computing it.

\smallskip

\noindent {\bf Input} \hskip2mm A finite algebra, $\bA = \<A, \dots\>$, and two congruence relations $\alpha$, $\beta \in \Con \bA$.

\smallskip
\noindent {\bf Procedure}
\begin{itemize}
\item {\bf Step 1} \hskip2mm Compute the congruence relation
  $\Deltaba = \Cg^{\bbeta}\bigl\{((a,a), (b,b)) \mid a \alphar b \bigr\}$.
\item {\bf Step 2} \hskip2mm Compute the commutator
  %% \begin{align*}
  %% [\alpha, \beta] &= \Psiba(0_A)
  %% = \{(x,y) \in A\times A \mid \bigl(\exists a \in A\bigr) \, (a,a) \Deltabar (x,y)\}\\
  %% &= \bigcup_{a\in A} (a,a)/\Deltaba
  %% \end{align*}
  \[[\alpha, \beta] 
  = \bigl\{(x,y) \in A\times A \mid (\exists a \in A) \, (a,a) \Deltabar (x,y)\bigr\} 
  =\bigcup_{a\in A} (a,a)/\Deltaba
    \]
\end{itemize}
Note that $\Deltaba$ is a subalgebra of $\bA^2 \times \bA^2$ and such a congruence
can be computed in polynomial-time in the size of $\bA$. (See~\cite{MR2470585}.)


\bibliographystyle{alphaurl}
\bibliography{refs}



\end{document}







%% OLD STUFF 


\appendix
\section{Appendix}
\subsection{Direct proof that commutator is a fixed point}

  Since $[\alpha, \beta] \in \Tol(A)$,
  we have $[\alpha, \beta] \leq \Psiba([\alpha, \beta])$
  by~(\ref{item:1}).
  We prove the reverse inclusion.
  %% $\Psiba([\alpha, \beta]) \subseteq [\alpha, \beta]$.
  If $(x,y)\in \Psiba([\alpha, \beta])$, then~(\ref{eq:7})
  implies there exists $(a,b)\in [\alpha, \beta]$ such that
    \begin{equation}
      \label{eq:1000}
     (a,b) \mathrel{\Delta_{\beta, \alpha}} (x,y).
    \end{equation}
    From the definition of $\Delta_{\beta, \alpha}$ and 
    \malcev's congruence generation theorem,~(\ref{eq:1000})
    holds if and only if
    $\exists \, z_i \betar z_i'$ $(0\leq i \leq n)$,
    $\exists \, u_i \alphar v_i$ $(0\leq i < n)$,
    $\exists\, f_i \in \Pol_1(\bA\times \bA)$ $(0\leq i < n)$
    such that
    $(a, b) = (z_0,z_0')$,
    $(x, y)=(z_n,z_n')$,
    \begin{align}
      \label{eq:0}
      \{(a, b),(z_1,z_1')\} &= \{f_0(u_0,u_0), f_0(v_0,v_0)\},\\
      \label{eq:1}
      \{(z_1,z_1'),(z_2,z_2')\} &= \{f_1(u_1,u_1), f_1(v_1,v_1)\},\\
      \nonumber
      &\; \; \vdots\\
      %% \label{eq:n-1}
      \nonumber
      %% \{(z_{n-2},z_{n-2}'),(z_{n-1},z_{n-1}')\} &= \{f_{n-2}(u_{n-2},u_{n-2}), f_{n-2}(v_{n-2},v_{n-2})\}, \text{ and }\\
      %% \nonumber
      \{(z_{n-1},z_{n-1}'),(x, y)\} &= \{f_{n-1}(u_{n-1},u_{n-1}), f_{n-1}(v_{n-1},v_{n-1})\}.
    \end{align}
    For each $(0\leq i < n)$, $f_i \in \Pol_1(\bA\times \bA)$, which means
    \newcommand\gA{\ensuremath{g^{\bA}}}%
    %% \begin{align*}
    \[      f_i(c, c') = g_i^{\bbeta}((c, c'), (a_1, a_1'), \dots, (a_k, a_k') )
      %% &= (g_i^{\bA}(x, a_1, a_2, \dots, a_k), g_i^{\bA}(x, a_1', a_2', \dots, a_k')),%
      = (g_i^{\bA}(c, \ba), g_i^{\bA}(c', \ba')),%
      %% \end{align*}%
      \]%
    \renewcommand\gA{\ensuremath{g}}%
    for some $k$, $\gA_i \in \sansClo_{k+1}(\bA)$, and constant tuples
    $\ba = (a_1, \dots, a_k)$ and $\ba' = (a_1', \dots, a_k')$ such that
    $a_i \betar a_i'$ ($1\leq i\leq k$). 
    By~(\ref{eq:0}), either
    \[
    (a, b) = \bigl(\gA_0(u_0, \ba), \gA_0(u_0, \ba')\bigr)
    \quad \text{ and } \quad 
    (z_1,z_1')= \bigl(\gA_0(v_0, \ba), \gA_0(v_0, \ba')\bigr),
    \]
    or vice-versa.  Since $u_0 \alphar v_0$ and 
    $a_i \betar a_i'$ ($1\leq i\leq k$), the $\alpha,\beta$-term condition
    entails
    %% \[
    %% \gA_0(u_0, \ba) \commr{\alpha}{\beta} \gA_0(u_0, \ba')
    %% \quad \Longleftrightarrow \quad 
    %% \gA_0(v_0, \ba) \commr{\alpha}{\beta} \gA_0(v_0, \ba').
    %% \]
    $\gA_0(u_0, \ba) \commr{\alpha}{\beta} \gA_0(u_0, \ba')$
    iff 
    $\gA_0(v_0, \ba) \commr{\alpha}{\beta} \gA_0(v_0, \ba')$.
    This and~(\ref{eq:0}) yield
    $(a,b)\in [\alpha, \beta]$ iff
    $(z_1,z_1')\in [\alpha, \beta]$.
    Similarly~(\ref{eq:1}) and $u_1 \alphar u_1$ imply
    $(z_1,z_1')\in [\alpha, \beta]$ iff
    $(z_2,z_2')\in [\alpha, \beta]$.  Inductively, we arrive at 
    $(a,b)\in [\alpha, \beta]$ iff $(x,y)\in [\alpha, \beta]$, as desired.
    We have thus proved $[\alpha, \beta]$ is a fixed point of $\Psiba$.
    %% Recall that the lattice order on $\Con \bA$ is complete, so t
    In other words, 
    $[\alpha, \beta]$ is ``$\Psiba$-closed.''
    %% (A set $B\subseteq \beta$ is called \defn{$\Psiba$-closed} provided
    %% $\Psiba(B) \subseteq B$.)

    %% We already proved $[\alpha, \beta]$ is $\Psiba$-closed, so it 
    It remains to check that $[\alpha, \beta] \leq \theta$ holds
    for every $\Psiba$-closed equivalence relation $\theta \in \downbeta$. 
    Fix a $\Psiba$-closed relation $\theta \leq \beta$. % (i.e., $\Psiba(B)\subseteq B$).
    It suffices to prove $\CC{\alpha}{\beta}{\Psiba(\theta)}$, since this implies 
    $[\alpha, \beta] \subseteq \Psiba(\theta) \subseteq \theta$.
    Thus, our goal is to establish the term condition
    $\CC{\alpha}{\beta}{\Psiba(\theta)}$.

    Let $p \in \Pol_{k+1}(\bA)$ and $a \alphar a'$ and $c_i \betar c_i'$ ($1\leq i\leq k$);
    suppose $p(a, \bc) \mathrel{\Psiba(\theta)} p(a, \bc')$.
    We prove that these hypotheses entail the following relation:
    \begin{equation}
      \label{eq:1001}
      p(a', \bc) \mathrel{\Psiba(\theta)} p(a', \bc').
    \end{equation}
    By definition of $\Psiba$, (\ref{eq:1001}) 
    is equivalent to the existence of
    some pair $(b,b') \in \theta$ such that
    $(b,b') \mathrel{\Delta_{\beta, \alpha}} (p(a', \bc), p(a', \bc'))$.
    %% We wish to %% establish the same for $(p(a', \bc), p(a', \bc'))$. That
    %% %% is, we must
    %% find such a pair for $(p(a', \bc), p(a', \bc'))$---that is, 
    %% a pair in $B$ that is $\mathrel{\Delta_{\beta, \alpha}}$-related to
    %% $(p(a', \bc), p(a', \bc'))$.
    Notice that the pair $(p(a, \bc), p(a, \bc'))$
    belongs to $\theta$ since
    $(p(a, \bc), p(a, \bc')) \in \Psiba(\theta) \subseteq \theta$.  Also,
    $c_i \betar c_i'$ ($0\leq i<k$) implies
    \begin{align*}
    ((a,a), (c_1, c_1'), (c_1, c_1'), \dots, (c_{k}, c_{k}'))&\in \beta^{k+1} \quad \text{ and }\\
    ((a',a'), (c_1, c_1'), (c_1, c_1'), \dots, (c_{k}, c_{k}')) &\in \beta^{k+1}.
    \end{align*}
    Therefore,
    \begin{align}
      \label{item:4}
    p^{\beta}((a,a), (c_1, c_1'), (c_1, c_1'), \dots, (c_{k}, c_{k}'))
    &= (p^{\bA}(a, \bc), p^{\bA}(a, \bc')) \in \beta  \quad \text{ and }\\
    \label{item:5}
    p^{\beta}((a',a'), (c_1, c_1'), (c_1, c_1'), \dots, (c_{k}, c_{k}'))
    &= (p^{\bA}(a', \bc), p^{\bA}(a', \bc')) \in \beta.
    \end{align}
    Finally, $a\alphar a'$ implies $p(a, \bc) \alphar p(a', \bc)$, and this---together
    with~(\ref{item:4}) and~(\ref{item:5})---proves the pair
    $\bigl((p(a, \bc), p(a, \bc')), (p(a', \bc), p(a', \bc'))\bigr)$
    belongs to  $\mathrel{\Delta_{\beta, \alpha}}$.
    Since  $(p(a, \bc), p(a, \bc')) \in \theta$, we have
    $(p(a', \bc), p(a', \bc')) \in \Psiba(\theta)$, completing the proof.


\bibliographystyle{alphaurl}
\bibliography{alt-refs.bib}

\end{document}

